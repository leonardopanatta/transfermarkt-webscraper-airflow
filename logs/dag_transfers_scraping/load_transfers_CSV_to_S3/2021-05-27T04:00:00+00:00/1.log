[2021-05-27 18:14:29,453] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: dag_transfers_scraping.load_transfers_CSV_to_S3 2021-05-27T04:00:00+00:00 [queued]>
[2021-05-27 18:14:29,503] {taskinstance.py:876} INFO - Dependencies all met for <TaskInstance: dag_transfers_scraping.load_transfers_CSV_to_S3 2021-05-27T04:00:00+00:00 [queued]>
[2021-05-27 18:14:29,504] {taskinstance.py:1067} INFO - 
--------------------------------------------------------------------------------
[2021-05-27 18:14:29,504] {taskinstance.py:1068} INFO - Starting attempt 1 of 1
[2021-05-27 18:14:29,504] {taskinstance.py:1069} INFO - 
--------------------------------------------------------------------------------
[2021-05-27 18:14:29,515] {taskinstance.py:1087} INFO - Executing <Task(PythonOperator): load_transfers_CSV_to_S3> on 2021-05-27T04:00:00+00:00
[2021-05-27 18:14:29,526] {standard_task_runner.py:52} INFO - Started process 97641 to run task
[2021-05-27 18:14:29,562] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'dag_transfers_scraping', 'load_transfers_CSV_to_S3', '2021-05-27T04:00:00+00:00', '--job-id', '153', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/dag_transfers_scraping.py', '--cfg-path', '/tmp/tmpzb3z9ra3', '--error-file', '/tmp/tmpek94vazs']
[2021-05-27 18:14:29,571] {standard_task_runner.py:77} INFO - Job 153: Subtask load_transfers_CSV_to_S3
[2021-05-27 18:14:29,691] {logging_mixin.py:104} INFO - Running <TaskInstance: dag_transfers_scraping.load_transfers_CSV_to_S3 2021-05-27T04:00:00+00:00 [running]> on host f7393dd572fa
[2021-05-27 18:14:29,811] {taskinstance.py:1282} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=dag_transfers_scraping
AIRFLOW_CTX_TASK_ID=load_transfers_CSV_to_S3
AIRFLOW_CTX_EXECUTION_DATE=2021-05-27T04:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-05-27T04:00:00+00:00
[2021-05-27 18:14:29,817] {base_aws.py:368} INFO - Airflow Connection: aws_conn_id=aws_s3_***_user
[2021-05-27 18:14:29,846] {base_aws.py:170} INFO - Credentials retrieved from extra_config
[2021-05-27 18:14:29,848] {base_aws.py:87} INFO - Creating session with aws_access_key_id=AKIAZP4IG4HNCZJ3LJDL region_name=None
[2021-05-27 18:14:29,885] {base_aws.py:157} INFO - role_arn is None
[2021-05-27 18:14:31,012] {taskinstance.py:1481} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1137, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1311, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1341, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 150, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/python.py", line 161, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/etl_scripts/transfers_scraping_etl.py", line 107, in load_CSV_on_S3
    self.s3.load_file(filename=f, bucket_name=self.s3_bucket_name, replace=True, key=key)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/amazon/aws/hooks/s3.py", line 62, in wrapper
    return func(*bound_args.args, **bound_args.kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/amazon/aws/hooks/s3.py", line 91, in wrapper
    return func(*bound_args.args, **bound_args.kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/providers/amazon/aws/hooks/s3.py", line 515, in load_file
    client.upload_file(filename, bucket_name, key, ExtraArgs=extra_args, Config=self.transfer_config)
  File "/home/airflow/.local/lib/python3.6/site-packages/boto3/s3/inject.py", line 131, in upload_file
    extra_args=ExtraArgs, callback=Callback)
  File "/home/airflow/.local/lib/python3.6/site-packages/boto3/s3/transfer.py", line 279, in upload_file
    future.result()
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/futures.py", line 106, in result
    return self._coordinator.result()
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/futures.py", line 265, in result
    raise self._exception
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/tasks.py", line 255, in _main
    self._submit(transfer_future=transfer_future, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/upload.py", line 551, in _submit
    upload_input_manager.provide_transfer_size(transfer_future)
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/upload.py", line 237, in provide_transfer_size
    transfer_future.meta.call_args.fileobj))
  File "/home/airflow/.local/lib/python3.6/site-packages/s3transfer/utils.py", line 245, in get_file_size
    return os.path.getsize(filename)
  File "/usr/local/lib/python3.6/genericpath.py", line 50, in getsize
    return os.stat(filename).st_size
FileNotFoundError: [Errno 2] No such file or directory: './dags/data/transfers_2021_05_27_18_14_25.csv'
[2021-05-27 18:14:31,017] {taskinstance.py:1531} INFO - Marking task as FAILED. dag_id=dag_transfers_scraping, task_id=load_transfers_CSV_to_S3, execution_date=20210527T040000, start_date=20210527T181429, end_date=20210527T181431
[2021-05-27 18:14:31,080] {local_task_job.py:151} INFO - Task exited with return code 1
